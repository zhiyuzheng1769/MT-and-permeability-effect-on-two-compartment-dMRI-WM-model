# Fixed diameter case results
This directory contains necessary files to reproduce the results in the paper from fixed diameter cylinder simulations (i.e., Figures 4, 5 and 7). Custom functions in [local_optim_fit.py](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/local_optim_fit.py) are used to perform parameter estimation (model fitting) based on a two-compartment signal model. To reproduce the results, follow the steps below:
1. Start Jupyter notebook with a Julia kernel by running ```pixi run julia-notebook``` from the repository directory in the terminal.
2. Switch to the fixed_diameter directory (this directory). Open and run all cells in the [create_cylinder notebook](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/create_cylinders.ipynb) to generate cylinders for MT and permeability simulations. Otherwise use pregenerated ones compressed in [MT_cylinders.zip](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/MT_cyl.zip) and [perm_cylinders.zip](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/perm_cyl.zip) (you need to decompress them and keep the same names for the uncompressed directories).
3. Write a shell script (see [run_MT_sims.sh](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/run_mt_sims.sh) and [run_perm_sims.sh](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/run_perm_sims.sh) for examples using `fsl_sub`) to run [simulate_mt.jl](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/simulate_mt.jl) and [simulate_permeability.jl](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/simulate_permeability.jl) on a computing cluster. Otherwise use pregenerated ones compressed in [MT_results.zip](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/MT_results.zip) and [perm_results.zip](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/perm_results.zip) (you need to decompress them and keep the same names for the uncompressed directories).
4. Run ```pixi run python-notebook``` from the repository directory in the terminal to start Jupyter Notebook with a python kernel. Switch to the fixed_diameter directory (this directory). Open and run all cells in the [Permeability figures.ipynb](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/Permeability%20figures.ipynb) and [MT figures.ipynb](https://github.com/zhiyuzheng1769/MT-and-permeability-effect-on-two-compartment-dMRI-WM-model/blob/main/fixed_diameter/MT%20figures.ipynb) to reproduce relevant figures in the result section. 
